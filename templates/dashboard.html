<!DOCTYPE html>
<html>
<head>
    <title>Local Experts Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <style>
        body { background-color: #f0f2f5; font-family: 'Roboto', sans-serif; color: #333; }
        .navbar-brand { font-family: 'Poppins', sans-serif; font-weight: 600; color: #2c3e50 !important; }
        .custom-navbar { background-color: #ffffff; padding: 15px 0; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05); border-radius:10px}
        .search-filter-form {
            background-color: #ffffff;
            border-radius: 10px;
            padding: 15px 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        .search-filter .form-control { border-radius: 8px; border: 1px solid; padding: 10px 15px; flex-grow: ; width:400px }
        .search-filter-form .dropdown-toggle { background-color: #f8f9fa; border: 1px solid #e0e0e0; border-radius: 8px; color: #555; padding: 10px 15px; white-space: nowrap; }
        .search-filter-form .btn-primary { background-color: #f8f9fa; border-color: #007bff; border-radius: 8px; font-weight: 500; }
        
        .worker-card {
            background-color: #ffffff;
            border: none;
            border-radius: 12px;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.06);
            padding: 20px;
            margin-bottom: 25px;
            text-align: center;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .worker-card:hover { transform: translateY(-5px); box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1); }
        .worker-photo { width: 90px; height: 90px; object-fit: cover; border-radius: 50%; margin-bottom: 15px; border: 3px solid #007bff; }
        .worker-card h5 { font-family: 'Poppins', sans-serif; font-weight: 600; color: #2c3e50; margin-bottom: 5px; }
        .worker-card .service-description { font-size: 0.95em; color: #666; margin-bottom: 10px; flex-grow: 1; }
        .worker-card .location { font-size: 0.85em; color: #888; margin-bottom: 15px; }
        .worker-card .btn-primary { background-color: #007bff; border-color: #007bff; border-radius: 8px; padding: 8px 20px; font-weight: 500; }
        .star-rating { color: #ffc107; margin-bottom: 10px; font-size: 1.1em; }
        .active { font-weight: bold; background-color: #e9ecef; }

        /* New styles for the vertical top workers list */
        .top-worker-card {
            display: flex;
            align-items: center;
            background-color: #fff;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            margin-bottom: 15px;
        }
        .top-worker-card .worker-photo {
            width: 70px;
            height: 70px;
            margin-right: 20px;
            margin-bottom: 0;
        }
        .top-worker-info {
            flex-grow: 1;
            text-align: left;
        }
        .top-worker-info h5 { margin-bottom: 2px; }
        .top-worker-info .location { margin-bottom: 5px; }
        .top-worker-card .btn-primary {
            min-width: 120px;
        }
        .profile-icon{width:20px;height:20px}
        .bg-light{padding:10px;max-width:1500px;justify-content:center;align-items:center}
    </style>
</head>
<body class="bg-light">

    


<nav class="navbar navbar-expand-lg custom-navbar">
    <div class="container-fuild flex-nowrap">
        <a class="navbar-brand" href="{{ url_for('dashboard') }}">
            
            LOCAL EXPERTS
        </a>
        <div class="d-flex align-items-center search-input-container">
            <form action="{{ url_for('dashboard') }}" method="GET" class="search-filter">
            <div class="input-group">
            <input type="text" name="search" class="form-control" placeholder="Search by location, service, or name..." value="{{ current_search }}">
            <button type="submit" class="btn btn-primary"><i class="fas fa-search"></i></button>
            </div>
            </form>
        </div>
        <div class="d-flex align-items-center">
             {% if current_worker_photo %}
            <a href="{{url_for('profile')}}">
            <img src="{{ url_for('static', filename='photos/' ~current_worker_photo) }}" 
                 class="profile-pic me-2" 
                 alt="Profile"
                 style="width:40px; height:40px; border-radius:50%; object-fit:cover;"></a>
        {% endif %}
        <a href="{{ url_for('logout') }}" class="btn btn-outline-light btn-sm">Logout</a>
      
        </div>

        

    </div>
</nav>

<div class="container-fuild mt-4">
    <form action="{{ url_for('dashboard') }}" method="GET" class="search-filter-form">
        
        <div class="btn-group">
            <button type="button" class="btn dropdown-toggle" data-bs-toggle="dropdown">{{ current_service | default('Service Type', true) }}</button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item {% if current_service == 'all' %}active{% endif %}" href="{{ url_for('dashboard', service='all', location=current_location, search=current_search) }}">All Services</a></li>
                <li><a class="dropdown-item {% if current_service == 'Plumbing' %}active{% endif %}" href="{{ url_for('dashboard', service='Plumbing', location=current_location, search=current_search) }}">Plumbing</a></li>
                <li><a class="dropdown-item {% if current_service == 'Electrician' %}active{% endif %}" href="{{ url_for('dashboard', service='Electrician', location=current_location, search=current_search) }}">Electrician</a></li>
                <li><a class="dropdown-item {% if current_service == 'Gardening' %}active{% endif %}" href="{{ url_for('dashboard', service='Gardening', location=current_location, search=current_search) }}">Gardening</a></li>
            </ul>
        </div>
        <div class="btn-group">
            <button type="button" class="btn dropdown-toggle" data-bs-toggle="dropdown">{{ current_location | default('Location', true) }}</button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item {% if current_location == 'all' %}active{% endif %}" href="{{ url_for('dashboard', location='all', service=current_service, search=current_search) }}">All Locations</a></li>
                <li><a class="dropdown-item {% if current_location == 'tirupati' %}active{% endif %}" href="{{ url_for('dashboard', location='tirupati', service=current_service, search=current_search) }}">tirupati</a></li>
                <li><a class="dropdown-item {% if current_location == 'Los Angeles' %}active{% endif %}" href="{{ url_for('dashboard', location='Los Angeles', service=current_service, search=current_search) }}">Los Angeles</a></li>
            </ul>
        </div>
    </form>

    {% if not current_search and current_service == 'all' and current_location == 'all' %}
    <h3 class="mb-3">‚≠ê Top-Rated Experts</h3>
    <div class="mb-5">
        {% for w in top_workers %}
        <div class="top-worker-card">
            <img src="{{ url_for('static', filename='photos/' ~w[6])}}" class="worker-photo">
            <div class="top-worker-info">
                <h5>{{ w[2] }}</h5>
                <p class="service-description mb-1">{{ w[7] }}</p>
                <p class="location mb-0"><i class="fas fa-map-marker-alt"></i> {{ w[5] }}</p>
            </div>
            <div class="star-rating me-4">
                {% for _ in range(w[8] // 200) %} <i class="fas fa-star"></i> {% endfor %}
            </div>
             <a href="{{ url_for('worker_details',worker_id=w['id']) }}" class="btn btn-primary">View Profile</a>
        </div>
        {% endfor %}
    </div>
    <hr>
    {% endif %}

    <h3 class="mb-3">All Local Workers</h3>
    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
        {% for w in workers %}
        <div class="col">
            <div class="worker-card">
                <img src="{{ url_for('static', filename='photos/' ~w[6]) }}" class="worker-photo"> <div class="star-rating">
                    {% for _ in range(w[8] // 200) %} <i class="fas fa-star"></i> {% endfor %}
                </div>
                <h5>{{ w[6] }}</h5>
                <p class="service-description">{{ w[7] }}</p>
                <p class="location"><i class="fas fa-map-marker-alt"></i> {{ w[5] }}</p>
                <a href="{{ url_for('worker_details',worker_id=w['id']) }}" class="btn btn-primary">View Profile</a>
                
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>

</html>


